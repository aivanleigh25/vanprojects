<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Movie Player</title>
  <link rel="stylesheet" href="output.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <style>
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 50;
      animation: fadeIn 0.3s ease-out;
    }
    .modal-content {
      background: #1a1f2b;
      margin: 5% auto;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      color: #ffffff;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
    }
    .close {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      cursor: pointer;
      color: #00C7B7;
    }
  </style>
</head>
<body class="bg-dark text-white font-inter min-h-screen">
  <!-- Sidebar -->
  <aside class="bg-sidebar text-white w-64 p-6 fixed h-full shadow-lg transition-all duration-300 z-40">
    <h2 class="text-xl font-bold mb-4">Menu</h2>
    <nav>
      <ul class="space-y-2">
        <li><a href="#contact" class="hover:text-teal block py-2 transition-colors">Contact</a></li>
        <li><a href="#ad-block" class="hover:text-teal block py-2 transition-colors">Ad-block</a></li>
        <li><a href="#imdb" class="hover:text-teal block py-2 transition-colors">IMDb</a></li>
        <li><a href="#about" class="hover:text-teal block py-2 transition-colors">About</a></li>
        <li><a href="#history" class="hover:text-teal block py-2 transition-colors">History</a></li>
      </ul>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="ml-64 p-6">
    <!-- Hero Section -->
    <section class="relative bg-cover bg-center h-48 mb-8" style="background-image: url('https://via.placeholder.com/1200x300?text=Movie+Hero');">
      <div class="absolute inset-0 bg-gradient-to-r from-black via-transparent to-black"></div>
      <div class="relative z-10 flex items-center h-full pl-6">
        <h1 class="text-4xl font-bold text-white">Movie Spotlight</h1>
      </div>
    </section>

    <!-- Watch History Section -->
    <section id="history" class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Watch History</h2>
      <button onclick="document.getElementById('historyModal').style.display='block'" class="bg-teal text-white px-4 py-2 rounded-lg hover:bg-teal-dark transition-all duration-200">View History</button>
      <div id="historyModal" class="modal">
        <div class="modal-content">
          <span class="close" onclick="document.getElementById('historyModal').style.display='none'">&times;</span>
          <h3 class="text-lg font-bold mb-2">Watch History</h3>
          <p>History content goes here...</p>
        </div>
      </div>
    </section>

    <!-- Free Movies Section -->
    <section id="movies" class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Free Movies</h2>
      <p class="mb-4 text-gray-300">Search or paste an IMDb ID (e.g., tt11083552), pick a server, then hit Watch.</p>
      <div class="flex flex-col md:flex-row gap-4 mb-6">
        <input type="text" id="searchInput" placeholder="Search or paste IMDb ID..." class="bg-gray-800 border border-gray-600 p-3 rounded-lg text-white w-full md:w-1/2 focus:outline-none focus:ring-2 focus:ring-teal transition-all duration-200">
        <button id="searchButton" class="bg-teal text-white px-4 py-2 rounded-lg hover:bg-teal-dark transition-all duration-200">üîç Search</button>
      </div>
      <div id="movieCards" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- Movie cards will be added dynamically from TMDB -->
      </div>
      <div id="playerSection" class="mt-6 hidden">
        <select id="serverSelect" class="bg-gray-800 border border-gray-600 p-3 rounded-lg text-white w-full mb-2 focus:outline-none focus:ring-2 focus:ring-teal transition-all duration-200">
          <option value="2embed">Server 1 ‚Äì 2Embed</option>
          <option value="vidsrcme">Server 2 ‚Äì Vidsrc.me</option>
          <option value="vidsrcto">Server 3 ‚Äì Vidsrc.to</option>
          <option value="test">Server 4 ‚Äì Test (fewer ads)</option>
        </select>
        <div class="flex space-x-3">
          <button id="watchButton" class="bg-teal text-white px-4 py-2 rounded-lg hover:bg-teal-dark transition-all duration-200">‚ñ∂ Watch</button>
          <button id="copyLinkButton" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-500 transition-all duration-200">üîó Copy Link</button>
          <button id="fullscreenButton" class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-500 transition-all duration-200">‚õ∂ Fullscreen</button>
        </div>
        <div id="movieInfo" class="mt-4 p-4 bg-gray-800 border border-gray-600 rounded-lg">
          <button id="infoToggle" class="text-teal hover:underline">More info ‚ñº</button>
          <div id="infoDetails" class="hidden mt-2 text-gray-300">
            <p>Release Date: <span id="releaseDate">N/A</span></p>
            <p>Overview: <span id="overview">N/A</span></p>
            <p>Rating: <span id="rating">N/A</span></p>
          </div>
        </div>
        <p id="readyTip" class="mt-2 text-sm text-gray-400">Ready. Tip: Press Enter or click Search to find movies.</p>
        <p id="headsUp" class="mt-2 text-sm text-gray-400">Heads-up: Only embed content you have the rights to watch. Some third-party players show ads; see Ad-block Help for tips. If a server fails, try a different one.</p>
      </div>
    </section>

    <!-- Ad-block Section -->
    <section id="ad-block" class="mb-8">
      <h2 class="text-2xl font-bold mb-4">Watch with fewer ads using <a href="https://ublockorigin.com/" class="text-teal hover:underline">uBlock Origin Lite</a></h2>
      <button onclick="document.getElementById('adBlockModal').style.display='block'" class="bg-teal text-white px-4 py-2 rounded-lg hover:bg-teal-dark transition-all duration-200">View Help</button>
      <div id="adBlockModal" class="modal">
        <div class="modal-content">
          <span class="close" onclick="document.getElementById('adBlockModal').style.display='none'">&times;</span>
          <h3 class="text-lg font-bold mb-2">Ad-block Help</h3>
          <p>These steps are for Chromium-based browsers (Chrome, Edge, Brave, etc.). For Firefox, install the classic uBlock Origin add-on.</p>
          <ol class="list-decimal ml-5 mt-2 text-gray-300">
            <li>Install <a href="https://chrome.com/webstore/detail/ublock-origin-lite/egnjhciaieccjhnbpfjgbkpfmglbcjdn" class="text-teal hover:underline">uBlock Origin Lite</a> from the Chrome Web Store.</li>
            <li>Pin it and make sure blocking is On for this site.</li>
            <li>Reload. Most popups/banners should be gone.</li>
          </ol>
        </div>
      </div>
    </section>

    <!-- About Section -->
    <section id="about">
      <h2 class="text-2xl font-bold mb-4">About this page</h2>
      <button onclick="document.getElementById('aboutModal').style.display='block'" class="bg-teal text-white px-4 py-2 rounded-lg hover:bg-teal-dark transition-all duration-200">View Details</button>
      <div id="aboutModal" class="modal">
        <div class="modal-content">
          <span class="close" onclick="document.getElementById('aboutModal').style.display='none'">&times;</span>
          <h3 class="text-lg font-bold mb-2">About this page</h3>
          <p>Search by movie title or paste IMDb ID. Click a movie card to load instantly in the player.</p>
        </div>
      </div>
    </section>
  </main>

  <script>
    // TMDB API Configuration
    const API_KEY = "6452370c23b5a8497b9a201cf46fba42";
    const TMDB_SEARCH = "https://api.themoviedb.org/3/search/movie?api_key=" + API_KEY + "&query=";
    const TMDB_DETAILS = id => `https://api.themoviedb.org/3/movie/${id}?api_key=${API_KEY}`;

    // Placeholder for Previous Website API
    const PREVIOUS_API_URL = 'https://yourpreviouswebsite.com/api'; // Update this URL
    const PREVIOUS_API_KEY = 'YOUR_PREVIOUS_API_KEY'; // Update if required

    const movieCards = document.getElementById('movieCards');
    const playerSection = document.getElementById('playerSection');
    const imdbRegex = /^tt\d{7,8}$/;

    // Fetch movies from TMDB
    async function fetchMovies(query = '') {
      try {
        const url = query ? `${TMDB_SEARCH}${encodeURIComponent(query)}` : `${TMDB_SEARCH}popular`;
        const response = await fetch(url);
        const data = await response.json();
        renderMovieCards(data.results);
      } catch (error) {
        console.error('Error fetching movies:', error);
      }
    }

    // Fetch movie details
    async function fetchMovieDetails(id) {
      try {
        const response = await fetch(TMDB_DETAILS(id));
        const data = await response.json();
        document.getElementById('releaseDate').textContent = data.release_date || 'N/A';
        document.getElementById('overview').textContent = data.overview || 'N/A';
        document.getElementById('rating').textContent = data.vote_average ? `${data.vote_average}/10` : 'N/A';
      } catch (error) {
        console.error('Error fetching movie details:', error);
        // Fallback to Previous API (placeholder)
        try {
          const previousResponse = await fetch(`${PREVIOUS_API_URL}/movie?id=${id}`, {
            headers: { 'Authorization': `Bearer ${PREVIOUS_API_KEY}` } // Adjust headers if needed
          });
          const previousData = await previousResponse.json();
          document.getElementById('releaseDate').textContent = previousData.release_date || 'N/A';
          document.getElementById('overview').textContent = previousData.overview || 'N/A';
          document.getElementById('rating').textContent = previousData.rating || 'N/A';
        } catch (prevError) {
          console.error('Error with previous API:', prevError);
        }
      }
    }

    // Render movie cards
    function renderMovieCards(movies) {
      movieCards.innerHTML = '';
      movies.forEach(movie => {
        const card = document.createElement('div');
        card.className = 'bg-gray-800 border border-gray-600 rounded-lg p-4 hover:bg-gray-700 transition-all duration-300 cursor-pointer';
        card.innerHTML = `
          <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" alt="${movie.title}" class="w-full rounded-t-lg" onerror="this.src='https://via.placeholder.com/300x450';">
          <h3 class="text-lg font-semibold mt-2">${movie.title}</h3>
          <p class="text-sm text-gray-400">IMDb ID: ${movie.imdb_id || 'N/A'}</p>
        `;
        card.addEventListener('click', () => {
          playerSection.classList.remove('hidden');
          fetchMovieDetails(movie.id);
        });
        movieCards.appendChild(card);
      });
    }

    // Initial load
    fetchMovies();

    // Search functionality
    document.getElementById('searchButton').addEventListener('click', () => {
      const searchInput = document.getElementById('searchInput').value.trim();
      if (imdbRegex.test(searchInput)) {
        fetchMovieDetails(searchInput.replace('tt', ''));
        renderMovieCards([{ id: searchInput.replace('tt', ''), title: 'Loading...', poster_path: '' }]);
      } else {
        fetchMovies(searchInput);
      }
    });
    document.getElementById('searchInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') document.getElementById('searchButton').click();
    });

    // Toggle info details
    document.getElementById('infoToggle').addEventListener('click', () => {
      document.getElementById('infoDetails').classList.toggle('hidden');
    });

    // Watch button (embed logic)
    document.getElementById('watchButton').addEventListener('click', () => {
      const imdbId = document.getElementById('searchInput').value.trim().replace('tt', '');
      const server = document.getElementById('serverSelect').value;
      let embedUrl = '';
      switch (server) {
        case '2embed':
          embedUrl = `https://2embed.to/embed/tmdb/movie?id=${imdbId}`;
          break;
        case 'vidsrcme':
          embedUrl = `https://vidsrc.me/embed/${imdbId}`;
          break;
        case 'vidsrcto':
          embedUrl = `https://vidsrc.to/embed/${imdbId}`;
          break;
        case 'test':
          embedUrl = `https://test.com/embed/${imdbId}`; // Placeholder
          break;
      }
      if (embedUrl) {
        playerSection.innerHTML = `
          <iframe src="${embedUrl}" frameborder="0" allowfullscreen class="w-full h-64 mt-4"></iframe>
          ${playerSection.innerHTML}`; // Preserve existing content
      }
    });

    // Copy link
    document.getElementById('copyLinkButton').addEventListener('click', () => {
      navigator.clipboard.writeText(window.location.href);
      alert('Link copied to clipboard!');
    });

    // Fullscreen
    document.getElementById('fullscreenButton').addEventListener('click', () => {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen().catch(err => {
          console.error('Fullscreen failed:', err);
        });
      } else {
        document.exitFullscreen();
      }
    });
  </script>
</body>
</html>
